<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Wasi Shorts Player</title>
  <style>
    * {margin:0; padding:0; box-sizing:border-box;}
    body {
      background: #000;
      overflow: hidden;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    iframe {
      width: 100vw;
      height: 100vh;
      border: none;
    }
    .loader {
      color: #fff;
      font-family: Arial, sans-serif;
      font-size: 1.2em;
      text-align: center;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
  </style>
</head>
<body>
  <div id="loader" class="loader">Loading Shorts...</div>

  <script>
    const apiKey = "AIzaSyCJ5f3o71_PJcI3q4NrdrtC7s9F2iVQVBw";
    const query = "Pakistani Indian song #shorts";
    let videos = [];
    let currentIndex = 0;
    let iframe;

    async function fetchShorts() {
      document.getElementById("loader").style.display = "block";
      const res = await fetch(
        `https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&maxResults=20&videoDuration=short&q=${encodeURIComponent(query)}&key=${apiKey}`
      );
      const data = await res.json();
      document.getElementById("loader").style.display = "none";
      videos = data.items.map(v => v.id.videoId);
      if (videos.length > 0) showVideo(0);
      else alert("No shorts found.");
    }

    function showVideo(index) {
      if (index < 0 || index >= videos.length) return;
      currentIndex = index;
      if (!iframe) {
        iframe = document.createElement("iframe");
        document.body.appendChild(iframe);
      }
      iframe.src = `https://www.youtube.com/embed/${videos[index]}?autoplay=1&mute=0&controls=0&modestbranding=1`;
    }

    // Scroll or swipe navigation
    let lastScroll = 0;
    window.addEventListener("wheel", e => {
      if (Date.now() - lastScroll < 800) return; // debounce
      lastScroll = Date.now();
      if (e.deltaY > 0) nextVideo();
      else prevVideo();
    });

    // Swipe (mobile)
    let touchStartY = 0;
    window.addEventListener("touchstart", e => (touchStartY = e.touches[0].clientY));
    window.addEventListener("touchend", e => {
      const diff = touchStartY - e.changedTouches[0].clientY;
      if (Math.abs(diff) > 50) diff > 0 ? nextVideo() : prevVideo();
    });

    function nextVideo() {
      if (currentIndex < videos.length - 1) showVideo(currentIndex + 1);
      else fetchShorts(); // load more when reaching end
    }

    function prevVideo() {
      if (currentIndex > 0) showVideo(currentIndex - 1);
    }

    fetchShorts();
  </script>
</body>
</html>
